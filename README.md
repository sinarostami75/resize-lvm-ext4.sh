##README برای اسکریپت افزایش فضای دیسک، پارتیشن، و LVMاین اسکریپت برای گسترش فضای یک پارتیشن، گروه ولوم (VG)، و ولوم منطقی (LV) نوشته شده است


توضیحات کلی

این اسکریپت Bash به شما کمک می‌کند فضای یک پارتیشن، گروه ولوم (VG)، و ولوم منطقی (LV) را به طور خودکار افزایش دهید. از ابزارهایی مانند parted, pvresize, lvextend, و resize2fs برای انجام عملیات استفاده می‌کند. این اسکریپت برای سیستم‌هایی طراحی شده است که از LVM (Logical Volume Manager) استفاده می‌کنند و فایل‌سیستم آن‌ها ext4 است.
نحوه کارکرد اسکریپت

    تغییر اندازه پارتیشن: پارتیشن مشخص‌شده در دیسک تا انتهای فضای دیسک گسترش می‌یابد.
    بروز رسانی Physical Volume: فضای اضافی به Physical Volume (PV) اضافه می‌شود.
    افزایش Logical Volume: ولوم منطقی تا حداکثر فضای موجود گسترش داده می‌شود.
    گسترش فایل‌سیستم: فایل‌سیستم موجود در ولوم منطقی برای استفاده از فضای جدید گسترش می‌یابد.

پیش‌نیازها

    سیستم‌عامل مبتنی بر لینوکس با LVM فعال.
    ابزارهای زیر باید نصب باشند:
        parted
        pvresize
        lvextend
        resize2fs (برای فایل‌سیستم‌های ext4)
        xfs_growfs (برای فایل‌سیستم‌های xfs، در صورت نیاز)
    دسترسی کاربر به سطح root یا sudo.

پارامترها

    DISK: نام دیسک اصلی. (به صورت پیش‌فرض /dev/sda)
    PARTITION: نام پارتیشن قابل گسترش. (به صورت پیش‌فرض /dev/sda3)
    VG_NAME: نام گروه ولوم. (به صورت پیش‌فرض ubuntu-vg)
    LV_NAME: نام ولوم منطقی. (به صورت پیش‌فرض ubuntu-lv)

نحوه استفاده

    مراحل اولیه:
        مطمئن شوید که از اطلاعات مهم سرور بکاپ گرفته‌اید.
        نام دیسک، پارتیشن، گروه ولوم، و ولوم منطقی را متناسب با سیستم خود تغییر دهید.
        مطمئن شوید که فایل‌سیستم شما ext4 یا سازگار با ابزارهای استفاده‌شده است.

    دریافت و اجرای اسکریپت:
        اسکریپت را دانلود یا کپی کنید.
        دسترسی اجرایی به اسکریپت بدهید:

chmod +x resize_lvm.sh

اسکریپت را اجرا کنید:

        sudo ./resize_lvm.sh

    نتایج:
    در صورتی که همه مراحل با موفقیت انجام شوند، فضای اضافی به پارتیشن، گروه ولوم، و ولوم منطقی اضافه خواهد شد و فایل‌سیستم آماده استفاده است.

نمونه اسکریپت

#!/bin/bash
DISK="/dev/sda"
PARTITION="/dev/sda3"
VG_NAME="ubuntu-vg"
LV_NAME="ubuntu-lv"

# Resize partition
parted $DISK resizepart 3 100%

# Resize physical volume
pvresize $PARTITION

# Extend logical volume
lvextend -l +100%FREE /dev/$VG_NAME/$LV_NAME

# Resize filesystem
resize2fs /dev/$VG_NAME/$LV_NAME

نکات مهم

    اگر فایل‌سیستم شما xfs است، به جای دستور resize2fs از دستور زیر استفاده کنید:

    xfs_growfs /dev/$VG_NAME/$LV_NAME

    در صورتی که دیسک یا پارتیشن خاصی استفاده می‌کنید، مقادیر متغیرهای DISK و PARTITION را مطابق نیاز تغییر دهید.

خروجی‌ها

    پیام موفقیت یا خطا در هر مرحله نمایش داده خواهد شد.
    اگر فرآیند به درستی انجام شود، فایل‌سیستم فضای بیشتری در اختیار خواهد داشت.

رفع مشکلات احتمالی

    دستورات مربوط به LVM پیدا نمی‌شوند:
    مطمئن شوید که بسته‌های lvm2 روی سیستم نصب شده‌اند:

sudo apt install lvm2

فضای پارتیشن تغییر نکرد:
بررسی کنید که پارتیشن انتخاب‌شده فضای آزاد در دیسک دارد:

lsblk

خطای فایل‌سیستم:
فایل‌سیستم ممکن است آسیب‌دیده باشد. دستور زیر را برای رفع مشکل اجرا کنید:

    sudo fsck /dev/$VG_NAME/$LV_NAME

لایسنس

این اسکریپت تحت لایسنس MIT منتشر شده و شما می‌توانید آزادانه از آن استفاده و آن را تغییر دهید.
